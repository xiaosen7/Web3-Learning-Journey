# 北京大学肖臻老师《区块链技术与应用》公开课_导读
2024年10月21日 20:13

## 关键词
比特币 哈希 签名 账户管理 SHA256 collision resistance hiding digital commitment puzzle friendly 密钥分发 区块链 工作量证明 目标阈值 挖矿 随机数 输入空间 输出空间 实践检验 MD five 非对称加密 


## 全文摘要
比特币系统利用哈希和签名两大密码学原理确保交易安全和完整。哈希函数特性如抗碰撞性和单向性，使得消息难以篡改，且能够保护预测股市涨跌结果的原始性和真实性，通过在结果公布前密封并由第三方保管，直至验证日公开，避免了结果泄露对市场的干扰。在实际应用中，通过在输入后添加随机数并取哈希，增强随机性和分布均匀性，而比特币挖矿过程体现了“难生成，易验证”的性质，通过SHA256哈希函数确保安全性与效率。比特币系统中，用户自行创建包含公钥和私钥的账户，公钥用于接收转账，私钥控制资金，非对称加密体系下的签名机制确保了交易的真实性。良好的随机源保证了公钥的唯一性，防止安全漏洞，同时在签名过程中保持随机性也是至关重要的。


## 章节速览
##### 00:00 比特币系统中的密码学原理
讨论了比特币系统中运用的两种核心密码学原理：哈希和签名。哈希函数，特别是加密哈希函数，具有抗碰撞性，使得找到两个不同的输入导致相同哈希值变得极为困难，确保了消息的完整性和真实性。此外，哈希函数的单向性（hiding property）使得从哈希值逆向推导原始输入变得困难，这一性质在实现数字承诺中扮演关键角色。

##### 11:25 预测结果的保密与验证方法
讨论了如何证明预测股市涨跌结果的准确性，提出了一种方法，即在预测结果公布前，将结果密封在信封中交由第三方保管，直到验证日再公开，以防止结果泄露影响市场。在电子世界中，利用哈希值的不可预测性和抗冲突性实现类似效果，确保预测结果的原始性和真实性。这种方法有效地解决了预测结果的保密与验证问题，保证了预测的公正性。

##### 15:19 哈希函数在比特币中的Puzzle Friendly性质
在实际操作中，对于需要保证输入空间足够大且分布均匀的场景，例如预测股票涨停，可以通过在输入后添加随机数并取哈希来增强随机性和分布均匀性。此外，比特币使用的哈希函数还要求具备Puzzle Friendly性质，这意味着哈希值的计算结果不可预测，需要通过尝试不同的输入来寻找满足特定条件（如前缀为特定数量零的哈希值）的输入，体现了寻找难题解的特性，因此得名Puzzle Friendly。

##### 18:39 比特币挖矿原理
挖矿是通过寻找随机数，将其与区块头信息结合，计算出的哈希值小于等于目标阈值的过程，用以验证交易的合法性。这个过程要求大量计算，但验证结果却很简单，体现了'难生成，易验证'的性质。比特币采用SHA256哈希函数，确保了安全性与效率。尽管puzzle friendly和collision resistance有联系，但不是完全相同。

##### 23:35 比特币账户管理及签名机制
讨论了比特币系统中的账户管理方式，用户在比特币系统中无需银行等机构批准，自行创建包含公钥和私钥的账户。说明了公钥类似银行账号，用于接收转账；私钥则是账户密码，用于控制资金。重点讲述了非对称加密体系在比特币中的应用，特别是签名机制：交易发布前使用私钥签名，发布后用公钥验证签名，以确保交易的真实性。

##### 30:51 比特币安全机制及随机性的重要性
讨论了比特币系统中，即使通过大量尝试生成相同的公钥，由于哈希函数的特性，成功概率极其低，接近于零。强调了随机性的关键作用，好的随机源能保证每个公钥的唯一性，而不良的随机源可能导致安全漏洞。此外，还提到了在签名过程中保持随机性的必要性，以防止私钥泄露。


## 思维导图
![思维导图图片](https://tw-efficiency.biz.aliyun.com/api/export/get/v2/r28pn7lvdzx95mzx-1729514081000-e8b87f13450d46f3905d2f4386426be9.jpg)
## 要点回顾
##### 比特币系统中使用了哪些密码学原理？
在比特币系统中，主要应用了密码学中的两个关键功能：哈希（hash）和签名。其中，哈希函数具有碰撞抵抗（collision resistance）的特性，即在理想情况下，很难人为地找到两个不同的输入产生相同的哈希值，从而确保了信息的完整性。

##### 哈希碰撞的性质和影响是什么？
哈希碰撞是指两个不同的输入产生相同的哈希值的现象。虽然理论上任何哈希函数都无法保证绝对的碰撞抵抗，但在实践中，如MD5这样的哈希函数经过长期检验并未发现高效制造碰撞的方法，因此被认为是碰撞抵抗的。这种性质在保护数据完整性方面至关重要，比如用于检测文件内容是否被篡改。

##### 哈希函数的hiding性质及其应用是什么？
hiding性质表示哈希函数计算过程是单向的，即从输入到哈希值的过程不可逆，不能从哈希值反推出原输入。这一特性结合碰撞抵抗性，可用于实现digital commitment，即数字信封，用于确保预测结果在公布前不被篡改，例如股市预测场景中的“黑盒”方案，以防止预测结果提前泄露影响市场。

##### 在电子世界中如何实现预测结果的密封信封功能？
通过将预测结果作为输入X计算出一个哈希值，然后公布这个哈希值。由于哈希值具有hiding性质，即从哈希值无法推断出原始预测结果；而在第二天收盘后公布实际预测结果，又利用了collision resistance性质，保证预测结果在公布前不会被篡改。

##### 如何确保哈希函数的hiding性质在实际操作中满足要求？
当输入空间不够大或分布不均匀时，通常会在输入后面拼接一个随机数再取哈希。通过这种方式，保证拼接后的输入既足够随机又分布均匀，从而实现hiding性质。

##### 比特币中所用的哈希函数除了密码学要求的两个性质外，还有哪个特殊性质？puzzle friendly性质在比特币挖矿中的具体体现是什么？
比特币中使用的哈希函数要求第三个性质——puzzle friendly。这意味着哈希值的计算是不可预测的，无法仅凭输入猜测其最终哈希值，因此在获取特定范围内的哈希值时，只能逐个输入尝试。puzzle friendly性质表现为挖矿过程需要大量试错才能找到符合要求的随机数（nance），使得区块头的哈希值小于等于指定的目标阈值。一旦找到合适的nance并发布，其他人验证该nance是否符合要求只需计算一次哈希值，这体现了“Difficult to show. But easy to verify”的性质。

##### 比特币中的账户管理是如何进行的？
比特币采用去中心化的方式管理账户，每个用户自行决定开户并生成一对公钥和私钥。公钥相当于账户的银行账号，私钥则是账户的密码。在交易过程中，交易发布者使用自己的私钥对交易进行签名，而接收者则用发布者的公钥验证签名的正确性，以此证明交易的真实性。

##### 为什么在比特币系统中需要公钥和私钥？
虽然比特币信息是公开的，但公钥和私钥的作用在于签名机制。当有人想转帐时，需用发送方的私钥对交易进行签名，接收方再用发送方的公钥验证签名的正确性，以此确保交易确实由发送方发起。

##### 如何防止多人生成相同的公钥对？
理论上，若所有用户都独立地生成公钥对，且哈希值是随机产生的，那么生成相同公钥对的概率极其微小，几乎不可能。不过，为了确保安全性，无论是生成公钥还是进行签名时，都必须使用高质量的随机源，否则可能导致私钥泄露并造成安全隐患。


## 提取PPT
##### 00:00 比特币系统中的密码学原理
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120548.png)
1. 区块链技术确保所有交易内容的公开性，包括账户地址和转账金额。
2. 比特币中运用密码学中的哈希和签名功能，哈希主要确保数据的完整性。
3. Cryptographic hash function具有碰撞抵抗性，这意味着难以找到两个不同的输入产生相同的哈希值。
4. 这一性质使得通过哈希值检测数据篡改成为可能，确保信息的原始性。
5. 实践经验而非理论证明哈希函数的碰撞抵抗性，经过多年检验的哈希函数未被发现可制造哈希碰撞的方法。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120549.png)
1. 哈希函数的主要特性包括抗冲突性，这意味着它非常难以找到两个不同的输入产生相同的哈希输出，这是通过实践经验得出的结论。例如，MD5曾被认为安全，但后来被发现存在制造哈希碰撞的方法。
2. 哈希函数的“隐藏”特性（或称单向性）指的是从哈希值很难（如果不是不可能）推导出原始输入。这使得哈希值不泄露任何关于原始输入的信息，从而为数字承诺提供基础。
3. 数字承诺类似于现实生活中密封信封的概念，用于确保信息的准确性和完整性不被篡改。例如，预测股市结果的场景可以利用哈希函数确保结果的不可篡改性和事后验证的可靠性。
4. 在实际操作中，为了满足哈希函数的隐藏特性，通常会在输入后面附加一个随机数，这能确保输入空间足够大且分布均匀，从而增加蛮力破解的难度。
5. 比特币等加密货币系统要求哈希函数具有“puzzle friendly”特性，这意味着计算哈希值的结果是不可预测的，从而增加了找到特定哈希值（如前面K位为0）的难度，这通常需要进行大量尝试。

##### 11:25 预测结果的保密与验证方法
##### 15:19 哈希函数在比特币中的Puzzle Friendly性质
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120550.png)
1. 哈希值的计算通常需要对输入进行大量的尝试，没有捷径可走，这体现了“puzzle friendly”的特性，即寻找特定哈希值的过程具有挑战性，确保了过程的安全性和复杂性。
2. 在这种“puzzle friendly”的计算过程中，输入的数据（特别是随机数nance）的选择至关重要，因为不同的输入将产生不同的哈希值，而找到满足特定条件的哈希值需要通过不断的尝试。
3. 比特币挖矿是利用哈希算法的这一特性来作为工作量证明（Proof of Work）的一部分，矿工们需要找到一个随机数nance，将其与区块头的其他信息结合，计算出的哈希值必须小于或等于一个预设的目标阈值。
4. 挖矿的过程实际上是在整个输出空间中寻找一个很小的target space内的解，这个过程要求矿工投入大量的计算工作，证明他们确实进行了相应的计算，从而确保了区块链网络的安全和去中心化。
5. 通过这种“puzzle friendly”的挖矿机制，比特币网络能够有效地防止恶意攻击，同时确保了新区块的生成需要一定的工作量，维护了区块链的稳定性和安全性。

##### 18:39 比特币挖矿原理
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120551.png)
1. 一旦有人找到了满足特定条件的nonce，发布之后，其他人验证这个nonce是否符合要求是非常简单的，因为只需要计算一次哈希值即可判断其是否小于等于预设的目标阈值。
2. 这种机制下，挖矿的过程是困难的，而验证过程是简单的，这种特性被称为“困难展示，容易验证”。
3. 在设计挖矿谜题时，我们必须考虑并利用这种“困难展示，容易验证”的性质，以确保系统的安全性和效率。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120552.png)
1. 比特币使用SHA256哈希函数，确保交易数据的安全和完整性。
2. SHA256具备安全性哈希特性，为比特币网络提供数据校验和防篡改能力。
3. Puzzle friendliness与collision resistance性质虽有相似之处，但分别强调不同的安全特性，确保哈希函数在不同场景下的适用性。
4. 比特币的安全性和交易验证高度依赖于密码学技术，包括哈希和数字签名机制。
5. 在比特币系统中，账户管理的核心在于私钥的持有与公钥的生成，以此来证明账户所有者的身份和交易权限。

##### 23:35 比特币账户管理及签名机制
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120553.png)
1. 在传统的中心化系统中，如银行开户，用户需携带证件去银行办理，这种方式需要通过银行等机构进行账户管理。
2. 比特币采用去中心化方式管理账户，每个用户自己决定开户，无需任何人批准，开户过程简单，只需创建一个公钥和私钥对。
3. 公钥和私钥的概念源于非对称加密体系，它解决了对称加密体系中密钥分发不方便的问题，非对称加密使用公钥加密和私钥解密。
4. 在非对称加密体系中，公钥可以公开，用于加密信息，而私钥需保密，用于解密信息，这使得密钥的分发更为安全和便捷。
5. 非对称加密体系的引入，使得在不安全的网络环境中也能安全地进行信息传输，因为即使公钥被知晓，只有持有对应私钥的人才能解密信息。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120554.png)
1. 在比特币系统中创建账户时，本地产生的一对公钥和私钥中，公钥相当于银行账号，用于接收转账；私钥则是账户密码，保护账户安全，防止未经授权的资金转移。
2. 比特币系统虽然信息公开，但通过公钥和私钥机制确保了交易的安全性和账户的真实性，即使信息不加密，也能通过签名技术验证交易的合法性。
3. 发起转账交易时，使用私钥对交易进行签名，这一操作确认了交易是由账户所有者发起的。接收方通过验证签名的公钥与签名机制，确保交易有效，增强了系统的安全性与透明度。
4. 每个比特币账户的生成独立进行，无需任何中心化机构批准，这不仅体现了比特币的去中心化特性，也保障了用户账户的自主性和私密性，同时确保了交易签名机制的有效执行。

##### 30:51 比特币安全机制及随机性的重要性
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120555.png)
1. 对于试图通过大量生成公钥对来匹配并窃取比特币的攻击方式，在理论上看似可行，但实际上由于256位哈希值的特性，两个公钥相同的可能性极其微小，即便使用超级计算机持续运算，这种概率也比地球爆炸的概率还要低。
2. 比特币系统中，公钥的生成及后续的签名过程都依赖于良好的随机性。若随机源不佳，即使是微小的偏差，也可能导致两个不同的个体生成相同的公钥对，从而威胁到私钥的安全。
3. 在比特币的签名算法中，每次签名不仅要求公钥的随机生成过程安全可靠，同时在每一次签名时也需使用高质量的随机源，以防止单次签名过程中的随机性不足导致私钥泄露。
4. 比特币系统通过结合使用哈希和签名技术来确保交易的安全。首先对交易信息（message）进行哈希处理，生成固定长度的哈希值，然后对这个哈希值进行签名，以此来验证交易的合法性和完整性。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/yg7k9w6va735nxwd/23120556.png)


