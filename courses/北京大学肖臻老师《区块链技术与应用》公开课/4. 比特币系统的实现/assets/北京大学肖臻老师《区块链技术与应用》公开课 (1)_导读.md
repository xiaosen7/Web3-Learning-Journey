# 北京大学肖臻老师《区块链技术与应用》公开课 (1)_导读
2024年10月25日 14:11

## 关键词
比特币 区块链 交易 UTXO 挖矿 区块 交易费 出块奖励 以太坊 挖矿难度 哈希值 铸币交易 coin base transaction 记账权 哈希 算力 安全性 double spending 最长合法链 概率分析 


## 全文摘要
讲师首先介绍了比特币协议的共识机制，随后深入探讨了比特币系统实现的细节。他强调了区块链作为去中心化账本的重要性，指出比特币采用基于交易的账本，每个区块记录交易而不直接显示账户余额。讲师详细解释了UTXO（未花费交易输出）数据结构，用于追踪未被使用的交易输出，确保系统能检测到双重支付。他进一步讨论了交易验证过程、经济激励机制，如出块奖励和交易费用，强调这些机制对矿工参与挖矿的重要性。讲师还深入探讨了比特币的安全性问题，包括区块链的不可篡改性、防止双重支付的方法，以及挖矿过程中的攻击和防范措施。最后，讲师指出比特币系统实现包含复杂机制，如挖矿的自我利益行为，并鼓励学生进一步研究以加深理解。整个对话旨在提供全面视角，帮助理解比特币系统原理和技术细节。


## 章节速览
##### 00:00 比特币系统实现及UTXO数据结构
本节课详细讲解了比特币系统的具体实现，重点讨论了基于交易的账本模式，即每个区块记录交易信息，包括转账和铸币交易。讨论了如何通过交易记录推算账户余额，并引入了UTXO数据结构，用以存储所有未被花费的交易输出，以检测double spending（双重支付）问题。UTXO集合内的每个元素包含产生输出的交易哈希值和输出序号，全节点维护此集合以便快速检测新交易的合法性。随着交易的进行，一些输出会被消耗，但也会产生新的输出，UTXO集合不断更新，但当前技术下存储在普通服务器内存中完全没问题。

##### 06:23 比特币交易机制及交易费机制解释
在比特币系统中，每个交易可以包含多个输入和输出，输入的总金额需等于输出的总金额，差额作为交易费。为了激励节点打包交易，除了区块奖励外，还设定了交易费机制。随着时间推移，区块奖励会逐渐减少，交易费可能成为主要收入。此外，对比特币基于交易的模式和以太坊基于账户的模式进行了对比，指出了两者的隐私保护性及实用性差异。

##### 15:45 区块链工作原理及挖矿机制解析
讨论了区块内交易、区块奖励与交易费用的对比，以及挖矿难度调整和随机数nance的使用。解释了区块头和交易树根哈希的重要性，并详细说明了通过调整coin base域作为挖矿策略的可能性，以此增加找到符合难度要求区块的几率。此外，还涉及了交易的具体结构和比特币交易费用的计算方法。

##### 26:10 比特币交易验证及挖矿概率分析
讲解了比特币系统中交易验证的流程，即通过配对并执行输入脚本和输出脚本以确认交易合法性，并指出了PPT内容可能引起的误解，强调区块头中仅包含交易信息的根哈希值，足以确保交易不被篡改。此外，还对挖矿过程进行了概率分析，解释了挖矿本质上是对nonce进行尝试以求解puzzle的过程。

##### 29:28 理解随机试验与矿工挖矿中的无记忆性原则
讨论了随机试验的概念，以掷硬币为例，强调了每次试验结果的独立性及无记忆性。在矿工挖矿的场景中，应用了泊松过程和指数分布来描述出块时间的随机性，强调了过往努力对当前成功概率无影响的特性，即无记忆性。这一特性保证了挖矿过程的公平性，防止了算力较强的矿工获得不成比例的优势。

##### 40:37 比特币挖矿机制及其激励机制
比特币的总量和挖矿奖励机制构成其稀缺性基础，每四年奖励减半，产生比特币构成几何序列。尽管奖励减少，比特币价格上涨使得挖矿价值上升，维持挖矿竞争激烈。此外，交易费用作为第二种激励机制，支撑挖矿活动持续。

##### 48:45 比特币安全分析及Double Spending攻击防范
在假设大部分算力由诚实矿工掌握的情境下，比特币能够提供一定程度的安全保障，但写入区块链的交易并非绝对合法。尽管如此，恶意节点试图篡改交易或重复花费（Double Spending）的尝试因签名要求及诚实节点的抵制而难以成功。防范措施包括等待多个区块确认，以降低交易被篡改的概率。同时，零确认情况下，交易虽未被记录在区块链中，但基于接收节点的接收策略及交易后处理时间，实际风险可控。

##### 01:05:38 Selfish Mining Attack in Blockchain
讨论了在区块链技术中，即使合法交易可能因区块大小限制而未能立即确认的情况。特别提到一种名为'selfish mining'的攻击方式，即矿工先挖出区块但不立即发布，而是等待其他矿工确认交易后再发布自己的区块，以此来获取更多奖励。这种攻击方式需要矿工拥有相当大的算力，例如超过50%的网络算力，以确保其策略的成功。讨论还指出，这种攻击方法虽然存在，但实际成功的可能性较低，因为大部分算力仍然忠于诚实的矿工网络。

##### 01:10:38 Selfish Mining Explained
讨论了'自私挖矿'的概念及其潜在好处和风险。在比特币系统中，'自私挖矿'是指挖出一个区块后不立即发布，而是继续挖矿以积累更多的区块，之后一起发布，从而获取额外的挖矿奖励。这种策略减少了与其他矿工的竞争，但存在一定的风险，如可能被其他矿工抢先发布区块，导致前功尽弃。此外，'自私挖矿'也提高了网络的整体算力需求，因为其他矿工在不知情的情况下继续在错误的链上工作。


## 思维导图
![思维导图图片](https://tw-efficiency.biz.aliyun.com/api/export/get/v2/r28pn7l7l7j95mzx-1729839268000-04d5980a49ce4ecca0dc57d446cdccfd.jpg)
## 要点回顾
##### 比特币系统中的账本模式是怎样的？
比特币采用的是基于交易的去中心化账本模式，每个区块记录的是交易信息，如转账交易和铸币交易。系统中并没有显示记录每个账户的具体余额，而是通过交易记录来推算。例如，要查看A账户上的余额，需要通过查看所有指向A地址的转账交易，计算已花费和未花费的币数，从而得出当前余额。

##### 交易如何与UTXO相互作用？
每笔交易会消耗掉一些UTXO中的输出，并可能产生新的输出。当交易确认后，新的输出会被添加回UTXO集合中。随着交易的不断发布和确认，UTXO集合会逐渐增大，但目前仍能装在一个普通服务器内存里。

##### UTXO是什么，它的作用是什么？
UTXO（未花费交易输出）是一个集合，包含所有尚未被花掉的交易输出。每个UTXO元素包含产生该输出的交易的哈希值以及在交易中的输出顺序。全节点维护这个数据结构是为了快速检测double spending（双重花费），即新发布的交易中的币是否只存在于未花费的状态中。如果要花费的币不在UTXO集合内，则说明该交易不合法。

##### 比特币系统中交易费用的作用是什么？
交易费用作为一种激励机制，鼓励矿工将他人的交易打包进区块。除了出块奖励外，矿工可以通过收取交易费来增加收益。目前，交易费金额较小，但随着出块奖励逐渐减小（每隔21万个区块减半），未来交易费可能成为主要收入来源。当前，大多数矿工争夺记账权的主要目的是获得出块奖励，但交易费的存在也激励了他们包含更多交易在区块中。

##### 除了比特币，还有基于账户模式的区块链系统吗？
是的，以太坊就是一个例子，它采用的是基于账户的模式，系统会显示记录每个账户拥有的币的数量，这使得查询账户余额更加直观便捷，类似于日常银行账户的余额查询。相比之下，比特币基于交易的模式在隐私保护方面表现更优，但牺牲了部分效率和便捷性，如每笔转账交易都需要明确表明币的来源。

##### 在比特币区块链中，区块包含的主要内容有哪些？
区块包含一系列交易信息，如686个交易、总输出的比特币数量、交易费用（约100倍小于出块奖励）、出块奖励本身以及挖矿难度等相关数据。

##### 矿工挖矿的主要动力是什么？区块的几个关键属性是什么？
矿工挖矿的主要动力是为了获得区块奖励（即出块奖励），而非交易费。关键属性包括区块序号（hit）、时间戳（Tim stem）、难度调整（Difficult）、随机数（Nance）以及三个哈希值：区块头的哈希值、前一个区块头的哈希值以及默克尔根哈希值。

##### 如何通过coin base域扩大搜索空间以增加找到符合难度要求区块的可能性？
可以将coin base域的前八个字节作为额外的调整参数（extraNonce），这样搜索空间就从2的32次方增大到了2的96次方，从而采用两层循环进行尝试。

##### 除了nance之外，还有哪些可以调整的字段会影响区块头的哈希值？
还可以调整区块产生的时间戳和coin base交易内容。其中，coin base交易虽然不能随意更改，但可以利用其指定的哈希值（digital commitment）来间接影响根哈希值。

##### 为什么区块和其前一个区块的哈希值开头有一长串零？
这是一般规律，因为挖矿过程需要通过调整随机数使区块头的哈希值小于等于目标阈值，目标阈值表现为前面有长串零的16进制数。

##### 在比特币挖矿中，nance这个32位无符号整数有何特殊之处？
nance用于挖矿时的尝试，但由于其只有二的32次方种可能取值，在当前高难度环境下，仅靠调整nance可能无法找到符合要求的区块。

##### 比特币系统如何验证交易合法性？
系统通过执行同一个交易中的输入脚本与之前提供B的来源交易的输出脚本配对，若执行顺利且无错误，则该交易被认为是合法的。

##### 在比特币的挖矿过程中，交易信息是否被包含在求哈希的过程中？
不，实际上求哈希时只使用了区块头的内容，交易的具体信息并不在区块头中。区块头里仅有一个默克尔树根哈希值，这足以保证整个区块中包含的交易无法被篡改。

##### 挖矿过程可以如何进行概率分析？挖矿成功的概率性质是什么？
挖矿过程可以视为一系列随机实验（blue trial），每次尝试nance来求解谜题的成功率非常低。当进行大量独立的随机实验时，可以近似为泊松过程，并通过指数分布来描述出块时间，即系统产生下一个区块的时间。挖矿成功的可能性小且每次尝试互不影响，具有无记忆性。这意味着无论之前的结果如何，未来每次挖矿成功的概率都是一样的。

##### 如果挖矿成功与工作量不成比例，会带来什么影响？
如果不满足无记忆性（progress free）条件，即过去的工作越多，接下来挖矿成功的概率越大，则算力强的矿工会获得不成比例的优势，这将破坏挖矿的公平性。

##### 比特币总量是如何计算的？
比特币总量是由出块奖励按照几何序列增长得出的，每四年减半一次。初始21万个区块产生50个比特币，之后每21万个区块减半一次，最终总量为2100万个比特币，既包括已挖出的部分，也包括未来将要产生的部分。

##### 对于一个去中心化且没有 membership 控制的系统来说，挖矿如何提供了一种有效的算力投票手段？
挖矿通过让大部分算力掌握在诚实节点手中，确保了系统的安全性。尽管表面上看似无用功且消耗大量电力，但这一机制对于维护整个系统的安全性至关重要。

##### 随着出块奖励减半，是否意味着挖矿动力会逐渐减弱？
实际上，尽管出块奖励减少，但由于比特币价格飙升，其价值反而增加，导致挖矿竞争愈发激烈。即使价格下跌，出块奖励趋于零时，由于还有交易费作为激励机制，所以并不会失去挖矿动力。

##### 在假设大部分算力由诚实矿工掌握的情况下，能否保证写入区块链的交易都是合法的？
挖矿可以提供概率上的保证，使得写入区块链的交易有较大可能是合法的，但不能完全保证。即使有90%的算力是诚实的，仍存在10%的概率记账权会被恶意节点获取。

##### 恶意节点能否成功将资金转给自己或进行double spending（双重花费）攻击？
在正常情况下，恶意节点无法成功伪造交易签名，因此无法将他人账户上的钱转给自己。即使获得记账权，由于无法获取有效签名，无法篡改区块，攻击不被诚实节点接受，攻击失败。对于double spending攻击，如果交易还未确认，攻击者可以在一段时间内通过创建分叉链来尝试回滚交易，但需要等待较长时间和其他节点的认可，这种方法在实际操作中难度很大。

##### 如何防范这类攻击？
防范攻击的方法之一是等待多个确认，即在交易刚被确认时暂时不确认，随着时间推移，区块不断延长，攻击者要改变交易状态的成本和难度显著增加。比特币协议默认要求等待六个确认才认为交易是不可篡改的，这意味着需要大约1小时的时间窗口。此外，还可以采用零确认（zero confirmation）的方式，即交易发布后还未被写入区块链时，虽存在篡改可能，但随着确认次数增多，交易的安全性将得到大幅提升。

##### 在比特币系统中，交易刚发布出去时，为什么不用等待交易被写入区块链就能确认交易的合法性？
比特币协议设计时，节点会最先接收并处理刚发布的交易。即使交易还未被包含在区块链中，诚实的节点通常不会接受重复的合法交易。此外，许多购物网站存在从支付成功到发货有一定时间间隔的情况，即使交易未被写入最长合法链，电商也可以在此期间选择取消发货。

##### 恶意节点获得记账权后，能否故意不包含某些合法交易在区块中？
恶意节点确实可以发布区块时不包含某些合法交易，因为比特币协议并未规定获得记账权的节点必须包含所有合法交易。然而，这种情况对整个系统影响不大，因为那些未能被当前区块包含的交易可以被写入下一个区块，并且总有诚实节点愿意发布这些交易。

##### 区块链正常工作时，是否也会出现合法交易未被包含的情况？
是的，正常情况下，如果交易数量过多而区块大小受到限制（目前每个区块最大容量为一兆字节），部分交易可能需要等待下一个区块来发布。

##### 针对提前算好并准备分叉攻击的策略，其原理是什么？
攻击者可以在M转给A的交易确认前，预挖好多个区块，并暂时不发布这些区块。当M到A的区块出现后，攻击者立即发布之前准备好的多个区块，形成分叉，试图覆盖主链。但这种方法的成功依赖于攻击者占据较大算力，例如51%以上，否则由于竞争机制，攻击者很难实现有效分叉。

##### 自我挖矿（selfish mining）为何会减少竞争压力？
自我挖矿是指矿工挖出区块后不立即发布，而是先藏起来并继续挖矿以积累更多的区块。这样，其他节点会沿主链持续挖矿，而攻击者已提前准备好多个区块，一旦主链上的区块被攻击者挖出，他可以快速发布自己的长链，从而获取额外的出块奖励。这样做可以减少其他竞争者的工作量，但也存在风险，即如果攻击者的区块未能连续发布，可能会丧失奖励。


## 提取PPT
##### 00:00 比特币系统实现及UTXO数据结构
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345783.png)
1. 比特币系统基于交易的账本模式，每个区块记录交易信息，包括转账和铸币交易，但不直接显示每个账户的余额，余额需通过交易记录推算得出。
2. 比特币全节点维护UTXO（未花费交易输出）数据结构，记录所有未被花费的交易输出，用以检测double spending（双重支付）。
3. 一个交易可能有多个输入和输出，输入总金额必须等于输出总金额。UTXO集合帮助检测交易合法性，确认交易中币的来源是否合法。
4. 交易可以有多个输入和输出，输入的金额总和需等于或大于输出总和，差额作为交易费支付给矿工，激励矿工打包交易。
5. 比特币系统通过区块奖励和交易费双重激励机制，矿工发布区块获得奖励和交易费，区块奖励将随时间逐渐减小，未来可能主要依靠交易费。

##### 06:23 比特币交易机制及交易费机制解释
##### 15:45 区块链工作原理及挖矿机制解析
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345784.png)
1. 这个例子来源于blockchain.info网站，展示了一个区块包含了686个交易，总输出的比特币数量和交易费用的总和，显著地，出块奖励比交易费用高出约100倍，说明矿工挖矿的主要动力是获得出块奖励。
2. 区块头的哈希值和前一个区块头的哈希值都以一长串零开头，这是挖矿过程中通过不断调整随机数来实现的，目的是使整个区块头的哈希值小于等于给定的目标阈值，这表明符合难度要求的区块其块头哈希值都具备这一特征。
3. 挖矿的难度每2016个区块调整一次，以维持区块的平均生成时间在10分钟左右，确保区块链网络的稳定性和安全性。这通过找到符合特定难度要求的随机数（nounce）来实现，展示了区块链技术如何通过计算难题来保障交易的确认和区块的创建。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345785.png)
1. 在比特币的区块头结构中，nonce是一个32位无符号整数，用于挖矿过程中调整，以满足特定难度要求。尽管nonce有\(2^{32}\)种可能值，但随着比特币难度增加，遍历所有可能值也很难找到符合条件的解决方案。
2. 挖矿难度的提升，加之比特币价格及参与人数的大幅增长，使得竞争异常激烈，单纯调整nonce已经不足以找到满足条件的区块头。
3. 区块头中的版本号固定，不可更改，代表当前使用的比特币协议版本。
4. 前一个区块的哈希值以及默克尔根哈希值在区块生成时由系统决定，不能随意修改，以确保区块链的连续性和数据完整性。
5. 区块生成时间在一定程度上可调，比特币系统不要求绝对精确的时间，允许在一定范围内调整，但不能偏离太远，以保证时间戳的可信度。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345786.png)
1. 比特币系统中的coin base交易是产生新比特币的唯一途径，这类交易没有输入，因为新币是系统自动生成的。
2. coin base交易中的一个特殊领域允许写入任何内容，这个内容在比特币网络中是不受检查的，可以用于诸如数字承诺，即将某个哈希值写入以防止信息被篡改。
3. 在比特币的第一节课中，我们用预测股票市场的例子来说明，提前公布预测结果可能会影响市场。通过在coin base交易中写入预测结果的哈希值，可以防止这一行为。
4. coin base交易的内容可以用于多种目的，比如表达个人感想，如“挖矿不易，且挖且珍惜”，这样的内容虽无实质用途，但增加了交易的趣味性。
5. 改变coin base交易中特定领域的内容，如数字承诺的哈希值，将直接影响区块头里的根哈希值，从而可能影响整个区块的哈希值，对区块的有效性和比特币网络的确认过程产生影响。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345787.png)
1. 对话内容描述了一个小型区块链系统中block header链表的结构，以及其中一个block header的根哈希值如何通过修改coin base transaction中的特定域而发生变化。
2. 描述了根哈希值的变化如何沿着moco tree的结构传递，最终影响block header，进而展示了通过修改coin base域作为extra数据，可以利用更多的存储空间（达2的96次方），来增大挖矿时的搜索空间。
3. 解释了实际挖矿过程中存在的两层循环机制：外层循环专注于调整coin base域的extra部分，内层循环则是根据调整后的extra值计算新的block header根哈希值。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345788.png)
1. 本次讨论的是一个比特币交易的例子，该交易涉及两个输入和两个输出，但实际看作是输入的输出。
2. 这些输出并未被标记为已使用的交易输出（UTXO），意味着它们仍然存在于比特币系统中，可供后续交易使用。
3. 交易的输入总金额与输出总金额之间的差额被定义为交易费用，表明了用户为交易验证过程支付的成本。
4. 比特币交易的有效性验证通过将输入脚本与输出脚本配对并执行来实现，确保交易的合理性和资金的流向正确。
5. 输入脚本和输出脚本的正确执行（无错误）是交易合法性的关键，表明了比特币系统中交易验证的严谨性。

##### 26:10 比特币交易验证及挖矿概率分析
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345789.png)
1. 这页PPT是该课程教科书的配套内容，旨在解释求解谜题的过程，但存在可能导致误解的部分，需要特别注意。
2. 在解释区块链中哈希计算时，PPT错误地将交易信息与区块头信息一同视为哈希计算的对象，实际操作中，哈希仅基于区块头内容进行，而不包括交易详情。
3. 区块头中仅包含默克尔树的根哈希值，这一信息足以确保区块内交易的不可篡改性，说明PPT中对区块头信息的描述有误导性。
4. 在教授过程中，特别指出PPT中易误解的部分，以避免学生形成错误概念，随后继续课程讲解，即对挖矿过程进行概率分析。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345790.png)
1. 挖矿过程被比喻为不断尝试各种nonce以求解某个谜题，每次尝试称为一个试验，展现了尝试性学习和解决问题的过程。
2. 最典型的蓝试验例子是掷硬币，每一次试验有两种可能结果，且每种结果的概率不一定是相等的，这取决于硬币的均匀性或非均匀性。
3. 对于挖矿而言，每次尝试成功的概率极低，需要大量的尝试才能找到符合要求的结果，这种情况下适用泊松过程进行近似，尤其当实验次数很多且每次成功的概率很小时。
4. 红试验过程的一个重要性质是无记忆性，意味着过去的实验结果不会影响后续实验的结果，体现了每个试验的独立性和随机性。
5. 举例说明，即便之前连续掷出反面，下次掷硬币正面朝上的概率依旧保持不变，体现了实验结果的无记忆特性。

##### 29:28 理解随机试验与矿工挖矿中的无记忆性原则
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345791.png)
1. 我们关注的是比特币系统中下一个区块的产生时间，这一时间符合指数分布。
2. 系统平均出块时间为十分钟，但个体矿工的出块时间受其算力比例影响，平均来说，占系统算力1%的矿工，每产生100个区块需等待1000分钟。
3. 指数分布的无记忆性意味着过去的工作时间和等待时间无关，接下来的等待时间仍然是十分钟，体现了挖矿过程的公平性。
4. 这种无记忆性防止了过去工作的累积效应，避免了算力强的矿工由于之前尝试更多而获得不成比例的优势，从而保证了挖矿的公平性。

##### 40:37 比特币挖矿机制及其激励机制
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345792.png)
1. 比特币的出块奖励每四年减半，这一机制确保了比特币总量的控制。
2. 出块奖励的减半遵循一个几何序列，最初每21万个区块产生50个比特币，随后每21万个区块奖励减半。
3. 通过几何序列的计算，21万个区块产生比特币的总和等于2100万个比特币，这部分涵盖了已经挖出及未来可能产生的所有比特币。
4. 比特币的总数量固定为2100万枚，这一设定保证了比特币不会因过量发行而贬值。

![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345793.png)
1. 比特币挖矿并非为了寻找特定的数学难题或质数，其主要目的是通过计算力解决复杂的哈希谜题，这个过程虽然缺乏实际意义，但对维护比特币网络的安全至关重要。
2. 比特币的挖矿难度和奖励机制是人为设计的，随着难度增加和奖励减半，比特币的稀缺性被人为创造，这确保了系统的长期稳定和价值维持。
3. 挖矿过程对于比特币系统而言，提供了一种公平的竞争机制，即通过算力的投入来“投票”，从而保障系统的去中心化和安全性。
4. 尽管比特币的出块奖励逐渐减少，但因为比特币价格的波动，奖励的实际价值反而在提升，这反而加剧了矿工之间的竞争，维护了系统的活力。
5. 比特币的安全性在很大程度上依赖于矿工的诚实行为。即便大部分算力掌握在诚实矿工手中，仍无法完全排除少数恶意矿工篡改交易的可能性，但这种概率极低，确保了大部分交易的有效性和安全性。

##### 48:45 比特币安全分析及Double Spending攻击防范
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345794.png)
1. 诚实的节点不会接受包含非法交易的区块，因为他们追求的是扩展最长合法链，非法区块无法获得认可，且攻击者因此失去奖励。
2. 对于double spending攻击，即尝试重复花费同一笔比特币，系统设计使得这种攻击在交易被多个区块确认后难以成功，因为多数节点会拒绝这样的交易。
3. 防范double spending攻击的一个方法是等待多个区块确认，即“多等几个确认”，比特币协议默认是等待六个确认，从而显著增加交易被篡改的难度。
4. 区块链的不可篡改性实际上是一种概率保证，即在交易被多个区块确认后，其被篡改的概率大幅度下降。但刚写入区块链的内容较为容易被改掉，强调了等待确认的重要性。
5. 虽然区块链被认为是不可篡改的，但在实际应用中，由于系统的某些特性，如zero confirmation，部分交易可以在未被区块链确认前就视为完成，这是基于节点接收交易的优先级及电商的处理时间。

##### 01:05:38 Selfish Mining Attack in Blockchain
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345795.png)
1. selfish mining策略允许矿工在挖出区块后先不发布，而是隐藏起来，等待时机再发布，以减少与其他矿工的竞争，提高挖出后续区块的机会，从而可能获得更高的奖励。
2. selfish mining的成功依赖于矿工所控制的算力比例，如果矿工所占算力小于50%，这种方法的成功可能性较低，因为算力分散使得隐藏区块并发布以抢先竞争区块的策略难以实现。
3. 此策略的另一个目的是通过隐藏区块来暂时欺骗网络，让其他矿工继续挖掘看似未完成的区块，这样当隐藏的矿工挖出后续区块时，可以利用等长链原则发布其区块，从而避免了与正在挖掘的区块矿工的竞争，增加了获取奖励的机会。
4. selfish mining策略虽然在理论上可以减少竞争，提高挖矿效率，但也伴随着风险，比如矿工可能因为无法挖出后续区块而错失机会，或在发布隐藏区块时发现其他矿工已经挖出了等长链，导致自身努力白费。
5. 尽管存在这些风险，selfish mining策略为矿工提供了一种在不完全控制网络算力的情况下增加收益的可能性，通过巧妙利用区块链的特性来优化挖矿过程中的竞争策略。

##### 01:10:38 Selfish Mining Explained
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/58gmq63g6ve8qzwo/23345796.png)


