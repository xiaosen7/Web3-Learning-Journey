# 北京大学肖臻老师《区块链技术与应用》公开课_导读
2024年10月24日 14:21

## 关键词
央行 数字货币 去中心化 双花攻击 防伪 区块链 私钥 公钥 签名 交易 哈希 验证 发行 通货膨胀 比特币 用户 挖矿 输入 输出 电商网站 


## 全文摘要
本次讨论集中于加密货币的设计原理与实现方法，尤其强调了去中心化背景下的加密货币创新。最初，假设存在一个中心化机构负责数字货币的发行，利用公私钥体系和非对称加密保证安全性，但这种方法面临私钥泄露和通货膨胀的风险。随后，转向区块链技术，探讨了如何通过区块链解决中心化带来的问题，特别是防范双花攻击和验证交易的有效性。以比特币为例，其通过全节点验证交易，并由矿工通过解决复杂计算难题来获得记账权，这一过程称为挖矿。比特币的共识机制确保了分布式网络中数据的一致性，矿工的算力决定了交易顺序和区块生成，体现了算力即投票权的机制。最终，比特币通过其独特的共识机制和激励机制维持了网络的稳定性和安全性。


## 章节速览
##### 00:00 数字货币发行机制探讨
讨论了在假设的中心化体系中，央行发行数字货币的简单方法，包括使用公私钥体系和非对称加密算法进行签名验证。然而，指出该方案存在多处安全隐患和实际问题，如私钥泄露风险、央行可能引起通货膨胀及破坏金融秩序等，强调了区块链在数字货币体系中的重要性及去中心化机制的必要性。

##### 04:27 数字货币机制及双花攻击防范
讨论了数字货币与传统纸质货币的区别，特别是关于‘双花攻击’（double spending attack）的防范机制。最初讨论了一个基于央行中心化管理的解决方案，其中每笔交易都需要央行确认，以防止同一数字货币被重复花费。然而，这种方法存在效率问题，因为任何两方的交易都需要通过央行进行验证。随后，提出了去中心化的概念，意指通过广大用户共同承担央行的角色，以解决中心化方案的局限性。

##### 09:24 解决数字货币发行与Double Spending问题
讨论了去中心化货币系统中数字货币发行和交易验证机制。提出比特币系统中挖矿决定货币发行，以及通过区块链维护交易记录来防止Double Spending。区块链作为一个公共账本，记录每一笔交易的输入和输出，通过哈希指针链接交易，确保货币来源的合法性，有效防止重复支付问题。

##### 17:31 比特币转账交易信息需求
进行比特币转账时，发送者（A）需要知道接收者（B）的地址，而这个地址是由B的公钥经过特定算法得出。虽然B的公钥是公开的，但并不需要所有人都知道。在日常转账中，类似的，A需要知道B的银行账号才能转账，这通常是B主动提供的，因为银行不提供查询个人账号的服务。在比特币系统中，没有提供查询特定人比特币地址的功能，需要通过其他渠道获得。转账时，A不需要知道B的任何信息，只需要证明自己有足够的比特币来源，并且不涉及任何关于B的信息证明。

##### 22:17 区块链中公钥验证机制
讨论了在区块链系统中，每个节点需要独立验证交易的合法性的必要性，特别是涉及到公钥的重要性。解释了公钥不仅用于验证交易签名，还用于确保资金来源的正确性。讨论了如果公钥信息被篡改可能导致的资金被盗，以及通过交易输入与输出中的哈希指针来验证公钥正确性的方法，防止了交易伪造。强调了公钥在交易中的双重验证作用，确保了资金安全流转。

##### 29:55 比特币交易验证及区块结构详解
比特币系统中的交易验证通过执行脚本实现，每个交易的输入和输出脚本需组合执行以验证合法性。交易脚本构成比特币的脚本语言，确保资金流动的合规性。每个区块不仅包含交易信息，还通过Merkle Tree结构保证交易列表的完整性和安全性。区块头信息包含版本、指向前一个区块的哈希、Merkle根哈希、挖矿难度目标及随机数等，确保区块的正确性和安全性。比特币系统中，节点根据功能分为全节点和轻节点，全节点需验证所有交易，而轻节点则依赖于全节点进行验证。

##### 37:55 区块链中全节点与轻节点的差异及共识机制
在区块链网络中，全节点和轻节点处理交易和维护区块链的方式存在显著差异。全节点保存所有区块链信息并验证每笔交易，保证交易的合法性和防止双重支付，而轻节点仅保存区块头信息，无法独立验证交易。大多数节点为轻节点，专注于利用区块链信息进行查询。为了确保区块链内容的一致性和账本的分布式共识，网络中的节点需要就交易的合法性和交易记录达成共识。这一过程对于维持区块链的去中心化特性至关重要。

##### 42:36 分布式共识机制及比特币中的应用
讨论了分布式系统中达成共识的挑战和理论，特别强调了异步系统中单个成员故障情况下无法达成共识的FLP不可能性结果，以及CAP定理表明在分布式系统中最多只能同时满足一致性、可用性和分区容错性中的两个。同时介绍了Paxos协议在保证一致性方面的优势及可能遇到的共识无法达成的问题。最后，转向探讨比特币中的共识协议，暗示这些理论与比特币的实际应用密切相关。

##### 50:07 解决比特币共识问题中的女巫攻击
在比特币系统中，即使大多数节点是好的，也有恶意节点可能通过产生大量账户来进行女巫攻击，操纵投票结果。直接基于投票的共识协议面临投票权确定、效率、网络延迟和可能的行政不作为问题。为了解决这些问题，需要设计更复杂的机制来避免单一节点或一小部分节点控制投票结果，确保区块链的正常运行。

##### 56:58 比特币记账权争夺机制与区块验证流程
在比特币系统中，节点通过计算力竞相获得记账权，用以添加新区块到区块链上。此过程涉及计算随机数，即nonce，以满足特定的哈希条件，确保区块的合法性。随后，网络中的其他节点会验证新区块的合法性和交易的有效性，包括交易签名和以往的花费情况。尽管区块内容可能在逻辑上合法，但基于特定的协议规则，某些情况下，即使区块在技术上无误，也可能因为插入位置不当或与其他区块的连贯性问题而不被接受。这种情形下，可能发生的攻击方式被称为分叉攻击，旨在通过创建非最长合法链的区块来干扰区块链的正常增长。

##### 01:07:22 区块链分叉及记账权争夺机制
讨论了区块链在正常运行中可能出现的分叉情况，以及当两个节点同时获得记账权时，如何通过组装不同区块来争夺链的扩展权。介绍了一旦出现分叉，比特币协议会默认接受最早收到的区块，及通过区块扩展来隐含接受区块的方式。同时，分析了分叉中两个区块链通过算力和运气竞争，最终一个会成为最长合法链，另一个则被抛弃。最后探讨了记账权争夺背后的机制，强调了保证所有合法交易都能被写入区块链的重要性，并提到了比特币中解决这一问题的巧妙机制。

##### 01:13:28 比特币出块奖励及其减半机制
在比特币协议中，获得记账权的节点可以得到一种特殊的奖励，即铸币交易Coinbase交易，允许其在区块中发布一定数量的比特币。最初，每产生一个新区块可以获得50个比特币，之后每21万个区块奖励减半一次，目前每区块奖励为12.5个比特币。比特币的发行通过这种机制控制，与传统交易不同，后者仅涉及已有比特币的转移。随着比特币价值的提升，区块奖励的绝对数值虽减少，但相对价值显著增加，从而加剧了节点间竞争区块记账权的现象。此外，如果出现区块链分叉，只有主链上的区块能够有效确认交易，分叉链上的Coinbase奖励区块内的比特币将失去作用。

##### 01:20:52 理解比特币的共识机制及其挖矿过程
本对话详细解释了比特币的共识机制，重点在于如何通过算力竞争来达成对区块链账本内容的共识。在比特币系统中，节点通过求解复杂的数学谜题（puzzle）来竞争记账权，即挖矿，这一过程实质上是依靠计算能力进行投票。对话中还提到了挖矿过程中的一些误区，比如创建多个账户并不能增加计算能力，以及解释了比特币挖矿与历史淘金热的相似之处，强调了挖矿的艰辛与潜在的高回报。


## 思维导图
![思维导图图片](https://tw-efficiency.biz.aliyun.com/api/export/get/v2/gpjbqkgp2p2nk2ao-1729751378000-6cf9b8cc59704ba1b1a89c09df481538.jpg)
## 要点回顾
##### 这种中心化数字货币发行方案的主要问题是什么？如何改进中心化方案以防止双花攻击？
该方案的主要问题是容易受到双花攻击（double spending attack）。由于数字货币可以被复制，一旦一个数字货币被用来购买某商品或服务，理论上可以将同一份数字货币再次支付给其他人，这就破坏了货币的唯一性和不可复制性，类似于纸质货币丢失后还能被他人使用。改进方案是在每个数字货币上增加编号，并建立一个由央行维护的大表记录每个编号对应的数字货币当前持有者。在进行支付时，不仅需要验证数字货币是否由央行签名，还需要核实央行数据库中该数字货币是否已被花出。如果数字货币已被他人花费，则无法再次使用，从而防范双花攻击。

##### 在中心化的数字货币系统中，央行如何发行数字货币？
在中心化的数字货币系统中，央行可以像发行纸质货币一样，通过印制带有央行私钥签名的数字货币来发行数字货币。例如，央行可以发行一个100元的数字货币，并使用其私钥进行签名，大家通过验证签名就可以确认其真实性。这种方法虽然看似可行，但存在私钥泄露等风险以及可能引发的通货膨胀问题。

##### 去中心化的数字货币系统需要解决的核心问题有哪些？
去中心化的数字货币系统需要解决两个核心问题：一是谁有权决定数字货币的发行以及何时、多少发行；二是如何验证交易的有效性，防止双花攻击。在比特币系统中，第一个问题的答案是由挖矿节点通过竞争获得铸币权来决定数字货币的发行；第二个问题则通过区块链技术来共同维护一个数据结构，记录每个比特币的所有权变更历史，确保交易的有效性和防止双花攻击。

##### 在比特币系统中，交易的来源和哈希指针是如何关联的？
在比特币系统中，交易的来源通过第二种哈希指针来体现，这种哈希指针指向了前面某个交易，用以证明资金的来源，并防止double spending（双重花费）攻击。当一个用户B要转账给C或D时，其他节点会检查这笔交易中币的来源是否已经被正确记录和确认。

##### 转账交易中需要哪些信息？
转账交易需要包含A（转账方）的签名以及B（收款方）的地址。收款方的地址是通过公钥经过特定算法转换得出的，类似于银行账号。在比特币系统中，A要转账给B，必须知道B的地址，而B的地址通常由B公开的公钥推算得出。

##### 比特币系统中是否提供查询功能让用户查找他人比特币地址？在比特币系统中，A给B转账时，B需要知道A的哪些信息？
比特币系统内部并没有提供查询功能让用户查找指定人的比特币地址。如同现实生活中的银行转账，需要用户自己获取并知道对方的银行账号才能完成转账。在比特币系统中，收款人的地址通常通过网站或其他渠道公开提供。在A给B转账的过程中，B不需要知道A的任何信息，但A需要证明他有足够的B来源，并且需要提供A的公钥信息。所有节点都需要知道A的公钥以便验证转账交易的签名是否合法。

##### 如何防止恶意节点冒充A进行转账操作？
比特币系统设计时考虑到安全性问题，交易不仅需要输入说明币的来源，还需要包含A的公钥。即使B的同伙B1尝试伪造A到B的转账交易，由于其他节点会使用A实际公开的公钥去验证签名，因此能够有效防止这种伪造行为的发生。

##### 在比特币系统中，如何验证交易中公钥的正确性？
在比特币系统中，交易中的公钥需要通过哈希指针与之前交易输出脚本中的公钥哈希进行对比验证。如果输入交易中的公钥哈希与输出脚本指定的A的公钥哈希不匹配，那么这个交易就无法通过验证，表明币的来源信息有误。

##### 比特币系统中的交易信息是如何加密和解密的？
比特币系统不进行信息本身的加密，但使用非对称加密体系来保护信息。发送方使用接收者的公钥加密信息，接收者则需要用自己的私钥解密。回复信息时，发送方同样使用接收者的公钥加密，接收者再用自己私钥解密。

##### 比特币系统中的验证过程是如何执行的？
比特币系统的验证过程通过执行脚本实现。每个交易的输入和输出都包含一段脚本，当验证一个交易时，会将当前交易的输入脚本与提供币的来源交易的输出脚本拼接起来，合成一段程序并运行，若执行无误，则该交易被认为是合法的。

##### 区块链中包含哪些组成部分以及它们的作用是什么？
区块链由多个区块组成，每个区块包括块头和块身两部分。块头包含了宏观信息如协议版本、前一个区块的哈希指针、Merkle树根哈希值、挖矿难度目标阈值和随机数等。块身则包含交易列表。整个块头的哈希值需要小于等于目标阈值，且指针指向的是区块的块头哈希，而轻节点仅保存块头信息，无法独立验证交易合法性。全节点保存所有区块链信息并验证每个交易，轻节点则通常用于查询而不参与区块链维护。

##### 在分布式系统中，为什么需要达成共识？
在分布式系统中，因为各个节点维护的区块链不是一条链，为了保证账本内容的一致性，当数据被记录到区块链上时，所有节点必须对账本内容有统一的认识和说法，这就需要通过分布式共识机制来确保这一点。

##### 分布式共识的一个实例是什么？
一个简单的分布式共识例子是分布式的哈希表，系统中多台机器共同维护一个全局的哈希表，需要达成共识的是哈希表中包含哪些键值对。无论在任何一台机器上插入或读取数据，其他机器都能获取到相同的信息。

##### FLP Impossibility Result是什么？
FLP Impossibility Result是分布式系统领域的理论研究结果，由三位分布式系统专家提出。该结论指出，在异步系统中（即网络传输时延无上限），即使系统中只有一个成员出现故障，也无法保证在这样的系统中达成共识。

##### CAP Theorem是什么？
CAP Theorem是分布式系统中的一个关键理论，其中C代表一致性（Consistency）、A代表可用性（Availability）和P代表分区容忍性（Partition Tolerance）。该定理表明，在一个分布式系统中，这三个性质无法同时满足，最多只能满足两个。例如，若追求一致性和可用性，则可能需要牺牲分区容忍性。

##### 比特币中的共识协议是如何设计的？
比特币中的共识协议面临的主要问题是抵抗恶意节点。一种设计方案是采用投票机制，每个节点可以提出候选区块，并由其他节点投票决定哪个区块被正式接受并写入区块链。然而，这种基于投票的方案存在效率低下、可能遭受女巫攻击等问题，最终比特币系统选择了使用计算力作为投票方式的独特机制来解决这些问题。

##### 在比特币区块链中，节点如何通过随机数获得记账权？
节点通过在区块中尝试不同的随机数（nance），组装好区块后，寻找能满足特定不等式条件的随机数，使得哈希值落在指定范围内。当某个节点找到符合要求的nance时，就获得了记账权，即有权利发布下一个区块。

##### 其他节点如何验证新区块的合法性？
其他节点接收到区块后，首先验证区块头的内容是否正确，包括检查NBS域（目标阈值编码）是否符合比特币协议规定的难度要求，并确认选用的nance是否使整个区块头的哈希值小于等于目标阈值。此外，还需验证区块体内的交易列表，确保每个交易都有合法签名且未被花过，只有所有检查都通过的区块才能被接受。

##### 如何根据区块链结构判断区块是否应在主链上接受？
根据区块链结构，区块应插在前一个区块之后，形成连续的链条。如果一个区块插在中间位置，意味着它破坏了原有的链式结构，导致double spending问题，即同一笔资金被花费两次。只有当区块按照最长合法链原则接在链尾才是合法的。

##### 如果出现两个节点几乎同时获得记账权并发布区块的情况，会发生什么？
在这种情况下的分叉攻击会导致区块链出现两个等长的分支。比特币协议规定，每个节点默认接受最早收到的那个区块。如果其中一个分支能够抢先找到下一个区块，则该分支将成为新的最长合法链，而另一个则被称为“水区块”并被丢弃。在这种临时性分叉中，最终胜出的分支取决于矿工或节点的计算能力和网络传播速度。

##### 是否可能存在合法区块因某些原因而不被接受的情况？
即使一个区块的内容都是合法的，包含有效交易且区块头设置无误，仍有可能因特定策略或恶意行为而不被接受。例如，尽管区块本身合法，但如果恶意节点拒绝接受该区块，即使它符合所有形式上的要求，也可能不被接受。

##### 在比特币系统中，为什么节点要竞争记账权，消耗大量计算资源去做这件事？
竞争记账权是因为比特币协议设计了一个机制，让获得记账权的节点可以决定哪些交易被写入下一个区块，并且在发布区块时能获得一定的奖励（即铸币交易coin base traction，可以发布一定数量的比特币）。虽然记账权的争夺看起来费电且消耗资源，但这是确保区块链正确运行和新增比特币发行的关键环节。

##### 出块奖励是如何随时间变化的？
比特币系统中，初始阶段每个区块的出块奖励为50个比特币。之后每21万个区块，出块奖励就会减半，例如从50个变为25个，再过21万个区块后又减半至12.5个比特币，现在每个区块只能产生12.5个比特币。

##### 比特币系统中，谁来决定发行货币？
比特币系统中，新比特币的发行通过coin base交易实现，这是比特币系统发行新币的唯一途径。这个交易本身并不需要指明币的来源，因为币是凭空创造出来的。

##### 当一个分叉胜出后，未被接纳的分叉上coin base所获得的区块奖励还有用吗？
如果一个较短的分叉无法成为主链最长合法链，那么在其上的coin base所获得的比特币奖励实际上是无效的，因为比特币协议要求接受最长链。只有在主链上的比特币才能被认可和使用。

##### 比特币共识机制要取得的具体共识是什么？
比特币共识机制要达成的是对去中心化账本内容的共识，即所有诚实节点都必须认可同一版本的分布式账本内容。获得记账权的节点通过解决一个计算 puzzle（挖矿）来添加新的区块到链中，而投票权重则是基于每个节点的哈希率（hash rate），即每秒钟尝试解决 puzzle 的次数。

##### 如何防范女巫攻击（simple attack）？
防范女巫攻击的关键在于投票方式基于算力而非账户数量。即便攻击者在一个服务器上创建多个账户，其投票权重并不会因此增加，因为投票权重取决于每秒钟能够尝试的 nance 数量，而非账户数量。

##### “挖矿”这一术语是如何形象描述争夺记账权的过程？
“挖矿”是对争夺记账权过程的一种比喻，类似于历史上的淘金热。节点通过求解 computational puzzle（挖矿）来寻找合法的 nance，成功找到并获得记账权的节点被称为“矿工”，他们挖出的区块就像从金矿中挖掘出的黄金一样，为比特币网络增添了新的供应量，并通过这个过程获得奖励。


## 提取PPT
##### 00:00 数字货币发行机制探讨
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289097.png)
1. 我们首先考虑一个中心化的数字货币发行方案，其中央行扮演发行数字货币的角色，并使用其私钥进行签名，以确保数字货币的真实性。这个方案利用了公私钥体系和非对称加密算法，但未涉及区块链技术。
2. 虽然上述方案在理论上看似可行，但存在几个关键问题：私钥的安全性、货币发行量的控制可能导致的通货膨胀以及无法防范双花攻击。
3. 为了解决双花攻击的问题，可以为每个数字货币赋予一个唯一编号，并维护一个由央行管理的交易记录数据库。然而，这一方案存在效率和隐私问题，因为所有交易都需要通过央行进行验证。
4. 为了构建一个去中心化的数字货币系统，需要解决数字货币发行权和交易验证问题。比特币系统中，通过“挖矿”机制决定货币发行，同时采用区块链作为数据结构来共同维护交易记录，以验证交易的有效性和防止双花攻击。
5. 比特币的区块链技术通过区块之间的链接和交易内的引用，创建了一个分布式账本，确保了交易的不可篡改性和货币的唯一性，从而解决了中心化方案中的关键问题。

##### 04:27 数字货币机制及双花攻击防范
##### 09:24 解决数字货币发行与Double Spending问题
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289098.png)
1. 冥币的来源是必须被证明的，以防止double spending，确保交易的资金是从合法的交易记录中提取出来的。如果尝试花费已经转给其他人或已经丢失的币，系统会检测到并拒绝这些不合法的交易。
2. 在比特币系统中，要进行转账，需要涉及交易的输入和输出。输入包括之前某个交易的输出，也就是钱的来源，输出则是本次转账的目标地址，由收款人的公钥哈希得到。交易的合法性需要通过验证输入脚本和输出脚本的匹配来确认。
3. 比特币交易中提到的A给B转账的例子，A需要知道B的地址（即公钥的哈希值），才能进行转账。但B不需要知道A的具体信息，因为交易验证过程只需确认A的签名有效性，而签名需要A的公钥来验证。
4. 为了避免冒名顶替的情况，比特币系统设计了输入和输出的哈希指针。如果交易中输入的A的公钥哈希与输出中指定的A的公钥哈希不匹配，那么该交易将被系统标记为不合法，防止了资金的非法转移。
5. 比特币的交易执行机制通过一段称为脚本的代码来实现，确保交易的输入脚本和输出脚本能够正确拼接执行，验证交易的合法性。每个交易的输入脚本和输出脚本结合后，如果能够顺利执行，那么该交易就是有效的。

##### 17:31 比特币转账交易信息需求
##### 22:17 区块链中公钥验证机制
##### 29:55 比特币交易验证及区块结构详解
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289099.png)
1. blow header包含了区块的一些宏观信息，比如使用的比特币协议版本、指向前一个区块的指针以及整个mocotree的根哈希值。
2. 区块头中的两个域特别相关于挖矿，包括挖矿难度的目标阈值（target）和随机数，其中目标阈值的哈希值必须小于等于这个值。
3. blow header中的目标域是一个编码，被称为NBS，它是用于确定区块头哈希是否满足挖矿要求的。
4. 区块头的哈希指针只算区块头部分，这种设计使block header成为串联区块链的关键，通过哈希指针形成链式结构。
5. 区块体（block body）包含交易列表，其根哈希（merkle root hash）确保交易列表不可篡改，尽管在讨论中简化假设所有节点验证所有交易，但实际上节点分为全节点和轻节点，全节点保存并验证所有信息，而轻节点仅保存区块头信息。

##### 37:55 区块链中全节点与轻节点的差异及共识机制
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289100.png)
1. 清节点由于缺乏以前的交易信息，无法独立验证交易的合法性，如double spending，这导致了大多数节点（清节点）在交易验证方面存在局限性。
2. 区块链系统中，交易信息的写入是由网络上的节点共同决定的，每个账户都可以发布交易，这些交易会广播给所有节点。
3. 交易合法性及是否写入区块的决策需通过分布式共识机制来达成一致，因为若每个节点独立决定，会导致区块链在不同节点间内容不一致，破坏了区块链作为去中心化账本的统一性。
4. 分布式共识是确保区块链上所有节点对账本内容有共同认识的关键，就像分布式哈希表那样，需要多台机器共同维护一个全局的、统一的数据结构。

##### 42:36 分布式共识机制及比特币中的应用
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289101.png)
1. 分布式共识问题在异步系统中，即使系统中只有一个成员有问题，也不可能在没有上限的网络传输延迟下达成共识。
2. 在分布式系统中，一致性(Consistency)、可用性(Availability)、分区容错性(Partition Tolerance)三个性质最多只能同时满足两个，即CAP定理。
3. 尽管有CAP定理的限制，共识协议如Paxos能够保证一致性，但可能会因为某些条件无法达成共识。
4. 比特币共识协议面临的主要挑战包括防止恶意节点通过不断提出非法区块来消耗资源，以及确保所有节点参与投票的可行性。
5. 为解决比特币共识问题，采用基于计算力的投票机制，而非简单的账户数量投票，以抵抗女巫攻击。

##### 50:07 解决比特币共识问题中的女巫攻击
##### 56:58 比特币记账权争夺机制与区块验证流程
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289102.png)
1. 每个节点都可创建候选区块，并尝试不同的随机数（Nonce）以满足比特币难度目标，以获得记账权。找到满足条件的Nonce的节点，即获得了向比特币区块链添加新区块的权利。
2. 获得记账权的节点发布新区块后，其他节点会验证区块的合法性，包括区块头和区块体的验证，确保所有的交易都是合法的，并且满足比特币协议中的难度要求。
3. 如果一个节点拒绝接收其他节点合法发布的区块，这可能导致分叉攻击，即恶意节点故意不接受合法区块，从而试图改变区块链的历史记录。
4. 在比特币中，如果两个节点几乎同时获得记账权并发布新区块，网络会出现分叉。比特币协议默认情况下，网络会接受最早接收到的区块，并继续扩展它，这可能导致一段时间内两个等长的分叉同时存在。
5. 分叉可能因为两个节点几乎同时找到新区块而发生，但最长的合法链最终会胜出。比特币网络中，新区块的接受和确认是一个动态过程，需要等待网络确认新区块后，才能确定哪一分叉是合法的。

##### 01:07:22 区块链分叉及记账权争夺机制
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289103.png)
1. 在区块链网络中，当出现分叉时，每个分叉都由一部分节点支持，节点会通过算力和运气竞争以决定哪个分叉能够生成下一个区块，最终形成最长的合法链，被社区广泛接受。
2. 节点为了争夺记账权而进行的计算资源消耗，表面上看是费力不讨好的事情，但实际上有其内在的价值。获得记账权的节点可以发布铸币交易，获得比特币作为奖励。
3. 比特币协议中，为了鼓励节点验证交易并争夺记账权，设计了“区块奖励”机制，即获得记账权的节点可以在新生成的区块中获得一定数量的比特币作为奖励。
4. 区块链技术需要解决的两个核心问题是：谁有权发行货币和如何验证交易的合法性。通过“区块奖励”机制，确保了交易验证者的激励，同时也规定了比特币的发行过程，即由矿工通过解决复杂的数学问题（挖矿）获得新币，从而控制了货币发行权。
5. 在比特币中，通过出块奖励机制，不仅解决了交易验证的激励问题，还巧妙地控制了货币发行，实现了去中心化数字货币系统中的货币发行和交易验证的平衡。

##### 01:13:28 比特币出块奖励及其减半机制
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289104.png)
1. 比特币系统中产生新币的唯一方式是通过区块奖励，即为解决数学谜题的“挖矿”过程。这个过程不涉及新币的创造，而是将已有的比特币从一个账户转移到另一个账户。尽管发行新币的过程不会创造新的比特币，但参与者需要耗费大量的计算资源来竞争区块奖励。
2. 比特币的区块奖励随着网络难度的调整而逐渐减半，最初是每50个比特币，之后减半至25个，再减半至12.5个。这一调整机制是比特币供应量逐渐减少的基础，目前每个区块的奖励为12.5个比特币，与比特币的总量上限为2100万枚相匹配。
3. 比特币的创始人中本聪的真身份至今未知，其神秘身份为比特币的起源增添了一层传奇色彩。比特币系统中的共识机制依赖于网络上的节点通过计算能力“投票”来决定区块的确认顺序，这个过程确保了比特币网络的安全性和去中心化特性。
4. 比特币的共识机制不仅要求记账节点通过“挖矿”竞争记账权，还要求这些节点遵循最长合法链原则。这意味着，比特币网络会优先认可那些构成最长链的区块，即使这些区块是由少数节点创建的，也能够有效抵抗女巫攻击等网络攻击。
5. 比特币的挖矿过程被比喻为传统的淘金过程，矿工们通过解决复杂的数学谜题来获得区块奖励，这既考验了矿工的计算能力，也象征着比特币网络的去中心化和安全性。这一过程不仅确保了比特币网络的持续运行，同时也为矿工们提供了潜在的经济激励。

##### 01:20:52 理解比特币的共识机制及其挖矿过程
![PPT图片](https://tw-efficiency.biz.aliyun.com/api/lab/get/v2/2yjoqzdaydkyn68l/23289105.png)


